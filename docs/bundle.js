(()=>{"use strict";var e={3134:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Channel=void 0;const s=r(3863),i=r(7524);t.Channel=class{subs=[];addSub(e){this.subs.push(e)}removeSub(e){this.subs=this.subs.filter((t=>t!==e))}getSubscriber(){return new i.ChannelSubscriber(this.addSub.bind(this),this.removeSub.bind(this))}getPublisher(){return new s.ChannelPublisher((e=>Promise.all(this.subs.map((t=>t(e)))).then((()=>{}))))}get subscriberCount(){return this.subs.length}}},3863:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelPublisher=void 0,t.ChannelPublisher=class{publish;constructor(e){this.publish=e}}},7524:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelSubscriber=void 0;const s=r(6409);class i{close;constructor(e,t){const r=this.publish.bind(this);e(r),this.close=()=>t(r)}[Symbol.asyncIterator](){return this}state={name:"WAIT",send:()=>{}};next(){if("DEAD"===this.state.name)return Promise.resolve({value:void 0,done:!0});if("BUSY"===this.state.name){const[e,t]=this.state.queue.shiftLeft();if(e.resolve(),null!==t)return this.state.queue=t,Promise.resolve({value:this.state.queue.head.message,done:!1})}return new Promise((e=>{this.state={name:"WAIT",send(t){e({value:t,done:!1})}}}))}return(){if("BUSY"===this.state.name)for(const e of this.state.queue)e.resolve();return this.state={name:"DEAD"},this.close(),Promise.resolve({value:void 0,done:!0})}publish(e){return new Promise((t=>{const r={message:e,resolve:t};switch(this.state.name){case"WAIT":this.state.send(e),this.state={name:"BUSY",queue:s.NonEmptyList.From([r]).orDie()};break;case"BUSY":this.state.queue=this.state.queue.appendElement(r)}}))}}t.ChannelSubscriber=i},9804:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2282:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CliCommand=void 0,t.CliCommand=class{commandName;keyedParameters;orderedParameters;constructor(e,t,r){this.commandName=e,this.keyedParameters=t,this.orderedParameters=r}}},5298:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CliCommandParser=void 0;const s=r(6768),i=r(2282);t.CliCommandParser=class{parse(e,t="CliCommandParser.parse input"){const[r,...o]=e.trim().replace(/\s+/g," ").split(" ");if(void 0===r)return s.Result.Failure(`${t} did not contain a valid command name`);const n={},a=[];for(const e of o){if(!e.startsWith("-")){a.push(e);continue}const[t,r]=e.replace(/^-+/,"").split("=");n[t]=r||!0}return s.Result.Success(new i.CliCommand(r,n,a))}}},8518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;const s=r(6985);class i{array;constructor(e){this.array=e}get length(){return this.array.length}get entries(){const e=this.array;return{*[Symbol.iterator](){for(let t=0;t<e.length;t++)yield[s.NonNegativeInteger.From(t).orDie(),e[t]]}}}get(e){const t=this.array[e.value];return void 0===t?s.Result.Failure(null):s.Result.Success(t)}static Empty(){return new i([])}get first(){return this.get(s.NonNegativeInteger.From(0).orDie())}map(e){return new i(this.array.map(((t,r)=>e(t,s.NonNegativeInteger.From(r).orDie(),this))))}appendElement(e){return new i([...this.array,e])}appendList(e){return new i(this.array.concat(Array.from(e)))}prependElement(e){return new i([e,...this.array])}*[Symbol.iterator](){for(const e of this.array)yield e}}t.List=i},6409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonEmptyList=void 0;const s=r(6985),i=r(4112),o=r(6768),n=r(8518);class a{head;tail;constructor(e,t=n.List.Empty()){this.head=e,this.tail=t}get length(){return s.PositiveInteger.From(1+this.tail.length).orDie()}get(e){return n.List.Empty().appendElement(this.head).appendList(this.tail).get(e)}appendElement(e){return new a(this.head,this.tail.appendElement(e))}shiftLeft(){return[this.head,a.From(this.tail).replaceFailureWith(null).value]}static From(e){const[t,...r]=e;return void 0===t?o.Result.Failure(i.Fault.Root("NonEmptyList cannot be empty.  I don't know what else to tell ya.")):o.Result.Success(new a(t,new n.List(r)))}*[Symbol.iterator](){yield this.head;for(const e of this.tail)yield e}}t.NonEmptyList=a},9291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringableSet=void 0;class r{uniquelyStringify;map;constructor(e=String,t={}){this.uniquelyStringify=e,this.map=t}static Empty(e=String){return new r(e)}has(e){return!!this.map[this.uniquelyStringify(e)]}add(e){const t=this.uniquelyStringify(e);if(t in this.map)return this;const s={...this.map,[t]:e};return new r(this.uniquelyStringify,s)}remove(e){const t=this.uniquelyStringify(e);if(!(t in this.map))return this;const s={...this.map};return delete s[t],new r(this.uniquelyStringify,s)}get size(){return Object.keys(this.map).length}*[Symbol.iterator](){yield*Object.values(this.map)}}t.StringableSet=r},3243:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IterableEventEmitter=void 0;class r{listeners=[];async*[Symbol.asyncIterator](){for(;;)yield await new Promise((e=>this.listeners.push(e)))}emit(e){for(const t of this.listeners)t(e);this.listeners=[]}}t.IterableEventEmitter=r},4112:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Fault=void 0;class r{message;context;cause;constructor(e,t={},r=null){this.message=e,this.context=t,this.cause=r}static Root(e,t={}){return new r(e,t)}wrap(e,t={}){return new r(e,t,this)}toString(){let e="";e+=`${this.message}\n`;for(const[t,r]of Object.entries(this.context))e+=`    ${t} = ${r}\n`;return this.cause?e+=`Because ${this.cause}`:e+="\n",e}}t.Fault=r},3140:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const s=r(4112),i=r(4877),o=r(6768);class n{redByte;greenByte;blueByte;constructor(e,t,r){this.redByte=e,this.greenByte=t,this.blueByte=r}static Black=n.FromString("#000").orDie();static Red=n.FromString("#f00").orDie();static Green=n.FromString("#0f0").orDie();static Blue=n.FromString("#00f").orDie();static White=n.FromString("#fff").orDie();toString(){return Number(this.redByte).toString(16).padStart(2,"0")+Number(this.greenByte).toString(16).padStart(2,"0")+Number(this.blueByte).toString(16).padStart(2,"0")}static FromString(e,t="Color.FromString input value"){return"#"===e.charAt(0)&&(e=e.slice(1)),e=e.toLowerCase(),o.Result.FromBoolean(/^[0-9a-f]{3,6}$/.test(e)).replaceFailureWith(s.Fault.Root(`${t} was not formatted correctly`)).map((()=>{const r=e.length/3;let s=e.slice(0,r),o=e.slice(r,2*r),a=e.slice(2*r);const l=parseInt(s.padEnd(2,s),16),c=parseInt(o.padEnd(2,o),16),u=parseInt(a.padEnd(2,a),16);return new n(i.Byte.From(l,`${t} red byte`).orDie(),i.Byte.From(c,`${t} green byte`).orDie(),i.Byte.From(u,`${t} blue byte`).orDie())}))}}t.Color=n},905:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClientError=void 0,t.HttpClientError=class{}},7572:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpHeaderCollection=void 0;const s=r(304);class i{internalRecord;constructor(e){this.internalRecord=e}*[Symbol.iterator](){for(const[e,t]of Object.entries(this.internalRecord))yield new s.HttpHeaderEntry(e,t)}static Empty=new i({});static From(e){return new i({...e})}set(e,t){return new i({...this.internalRecord,[e]:t})}}t.HttpHeaderCollection=i},304:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpHeaderEntry=void 0,t.HttpHeaderEntry=class{key;value;constructor(e,t){this.key=e,this.value=t}}},3258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1237:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequest=void 0;const s=r(9317);t.HttpRequest=class{method;url;headers;body;constructor(e,t,r=s.HttpHeaderCollection.Empty,i=""){this.method=e,this.url=t,this.headers=r,this.body=i}}},6265:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequestUrlQuery=void 0;const s=r(6768);class i{native;constructor(e){this.native=e}*[Symbol.iterator](){for(const[e,t]of this.native)yield[e,t]}static Empty=new i(new URLSearchParams);static From(e,t="HttpRequestUrlQuery.From input"){switch(typeof e){case"string":return s.Result.Success(this.FromString(e));case"object":return s.Result.Success(e?this.FromObject(e):this.Empty);default:return s.Result.Failure(`${t} could not be normalized to an HttpRequestUrlQuery`)}}static FromString(e){return new i(new URLSearchParams(e))}static FromObject(e){const t=new URLSearchParams;for(const[r,s]of Object.entries(e))t.set(r,String(s));return new i(t)}add(e,t){const r=new URLSearchParams;for(const[e,t]of this.native)r.set(e,t);return r.set(e,t),new i(r)}getFirst(e){for(const[t,r]of this)if(t===e)return s.Result.Success(r);return s.Result.Failure(null)}*getAll(e){for(const[t,r]of this)t===e&&(yield r)}toString(){return this.native.toString()}get isEmpty(){return 0===Array.from(this.native).length}}t.HttpRequestUrlQuery=i},4198:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpResponse=void 0;const s=r(9317),i=r(383),o=r(3124);t.HttpResponse=class{status;body;headers;constructor(e=i.HttpResponseStatus.Ok,t="",r=s.HttpHeaderCollection.Empty){this.status=e,this.body=t,this.headers=r}toString(){return JSON.stringify(this)}get ok(){return this.status.isSuccess}structure(e){return new o.HttpStructuredResponse(this.status,e,this.headers)}}},383:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpResponseStatus=void 0;const s=r(4112),i=r(6768);class o{code;text;constructor(e,t){this.code=e,this.text=t}static Continue=new o(100,"Continue");static SwitchingProtocol=new o(101,"Switching Protocol");static Processing=new o(102,"Processing");static EarlyHints=new o(103,"Early Hints");static Ok=new o(200,"OK");static Created=new o(201,"Created");static Accepted=new o(202,"Accepted");static NonAuthoritativeInformation=new o(203,"Non-Authoritative Information");static NoContent=new o(204,"No Content");static ResetContent=new o(205,"Reset Content");static PartialContent=new o(206,"Partial Content");static MultiStatus=new o(207,"Multi-Status");static AlreadyReported=new o(208,"Already Reported");static ImUsed=new o(226,"IM Used");static MultipleChoice=new o(300,"Multiple Choice");static MovedPermanently=new o(301,"Moved Permanently");static Found=new o(302,"Found");static SeeOther=new o(303,"See Other");static NotModified=new o(304,"Not Modifed");static TemporaryRedirect=new o(307,"Temporary Redirect");static PermanentRedirect=new o(308,"Permanent Redirect");static BadRequest=new o(400,"Bad Request");static Unauthorized=new o(401,"Unauthorized");static PaymentRequired=new o(402,"Payment Required");static Forbidden=new o(403,"Forbidden");static NotFound=new o(404,"Not Found");static MethodNotAllowed=new o(405,"Method Not Allowed");static NotAcceptable=new o(406,"Not Acceptable");static ProxyAuthenticationRequired=new o(407,"Proxy Authentication Required");static RequestTimeout=new o(408,"Request Timeout");static Conflict=new o(409,"Conflict");static Gone=new o(410,"Gone");static LengthRequired=new o(411,"Length Required");static PreconditionFailed=new o(412,"Precondition Failed");static PayloadTooLarge=new o(413,"Payload Too Large");static UriTooLong=new o(414,"URI Too Long");static UnsupportedMediaType=new o(415,"Unsupported Media Type");static RangeNotSatisfiable=new o(416,"Range Not Satisfiable");static ExpectationFailed=new o(417,"Expectation Failed");static ImATeapot=new o(418,"I'm a teapot");static EnhanceYourCalm=new o(420,"Enhance Your Calm");static MisdirectedRequest=new o(421,"Misdirected Request");static UnprocessableEntity=new o(422,"Unprocessable Entity");static Locked=new o(423,"Locked");static FailedDependency=new o(424,"Failed Dependency");static TooEarly=new o(425,"Too Early");static UpgradeRequired=new o(426,"Upgrade Required");static PreconditionRequired=new o(428,"Precondition Required");static TooManyRequests=new o(429,"Too Many Requests");static RequestHeaderFieldsTooLarge=new o(431,"Request Header Fields Too Large");static UnavailableForLegalReasons=new o(451,"Unavailable For Legal Reasons");static InternalServerError=new o(500,"Internal Server Error");static NotImplemented=new o(501,"Not Implemented");static BadGateway=new o(502,"Bad Gateway");static ServiceUnavailable=new o(503,"Service Unavailable");static GatewayTimeout=new o(504,"Gateway Timeout");static HttpVersionNotSupported=new o(505,"HTTP Verson Not Supported");static VariantAlsoNegotiates=new o(506,"Variant Also Negotiates");static InsufficientStorage=new o(507,"Insufficient Storage");static LoopDetected=new o(508,"Loop Detected");static NotExtended=new o(510,"Not Extended");static NetworkAuthenticationRequired=new o(511,"Network Authentication Required");static FromCodeNumber(e){const{Ok:t,Created:r,NoContent:n,NotModified:a,BadRequest:l,Unauthorized:c,Forbidden:u,NotFound:d,Conflict:h,InternalServerError:p,...m}=o,f=[t,r,n,a,l,c,u,d,h,p];for(const t of f)if(t.code===e)return i.Result.Success(t);for(const t in m){const r=m[t];if(r instanceof o){const t=r;if(t.code===e)return i.Result.Success(t)}}return i.Result.Failure(s.Fault.Root("Unknown or invalid http status code",{statusCode:String(e)}))}get isInformation(){return"1"===String(this.code)[0]}get isSuccess(){return"2"===String(this.code)[0]}get isRedirect(){return"3"===String(this.code)[0]}get isBadRequest(){return"4"===String(this.code)[0]}get isServerError(){return"5"===String(this.code)[0]}}t.HttpResponseStatus=o},3124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpStructuredResponse=void 0;const s=r(9317),i=r(383);t.HttpStructuredResponse=class{status;body;headers;constructor(e=i.HttpResponseStatus.Ok,t,r=s.HttpHeaderCollection.Empty){this.status=e,this.body=t,this.headers=r}toString(){return JSON.stringify(this)}}},9849:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IrcV3Message=void 0,t.IrcV3Message=class{tags;prefix;command;parameters;constructor(e,t,r,s){this.tags=e,this.prefix=t,this.command=r,this.parameters=s}}},1603:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IrcV3Parser=void 0;const s=r(9849);function i(e){const t=e.indexOf(" ");return-1===t?[e,""]:[e.slice(0,t),e.slice(t+1)]}t.IrcV3Parser=class{*parse(e){for(const t of e.split("\r\n").map((e=>e.trim())).filter(Boolean)){let e=t;const r={};if("@"===e.charAt(0)&&e.includes(" ")){let t;[t,e]=i(e);for(const e of t.slice(1).split(";")){const[t,s]=e.split("=",2),i=s.replace(/\\:/g,";").replace(/\\s/g," ").replace(/\\\\/g,"\\").replace(/\\r/g,"\r").replace(/\\n/g,"\n");r[t]=i}}let o,n="";if(":"===e.charAt(0)&&e.includes(" ")){let t;[t,e]=i(e),n=t.slice(1)}[o,e]=i(e);const a=[];for(;e;){if(":"===e.charAt(0)){a.push(e.slice(1)),e="";break}let t;[t,e]=i(e),a.push(t)}yield new s.IrcV3Message(r,n,o,a)}}}},1232:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NumberMarshaler=void 0,t.NumberMarshaler=class{byteOffsetToSignificance;byteSignificanceToOffset;constructor(){let e=0;e=e/256+1,e=e/256+2,e=e/256+3,e=e/256+4,e=e/256+5,e=e/256+6,e/=16,e+=1,e*=Math.pow(2,-911),this.byteOffsetToSignificance=new Uint8Array(Float64Array.from([e]).buffer),this.byteSignificanceToOffset=new Uint8Array(8),this.byteOffsetToSignificance.forEach(((e,t)=>{this.byteSignificanceToOffset[e]=t}))}numberToLittleEndianBytes(e){const t=new Uint8Array([0,1,2,3,4,5,6,7]),r=this.getBytesInOffsetOrder(e);return t.map((e=>this.byteSignificanceToOffset[e])).map((e=>r[e]))}numberToBigEndianBytes(e){const t=new Uint8Array([7,6,5,4,3,2,1,0]),r=this.getBytesInOffsetOrder(e);return t.map((e=>this.byteSignificanceToOffset[e])).map((e=>r[e]))}getBytesInOffsetOrder(e){return new Uint8Array(Float64Array.from([e]).buffer)}}},6129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractNumberable=void 0,t.AbstractNumberable=class{value;constructor(e){this.value=e}valueOf(){return this.value}lt(e){return Number(this)<Number(e)}gt(e){return Number(this)>Number(e)}lte(e){return Number(this)<=Number(e)}gte(e){return Number(this)>=Number(e)}eq(e){return Number(this)===Number(e)}neq(e){return Number(this)!==Number(e)}}},4877:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Byte=void 0;const s=r(4112),i=r(6768);class o{trustedNumber;constructor(e){this.trustedNumber=e}static From(e,t="Byte.From input value"){const r=Number(e);return isNaN(r)?i.Result.Failure(s.Fault.Root(`${t} could not be converted to a number`)):Number.isInteger(r)?r<0?i.Result.Failure(s.Fault.Root(`${t} was negative`)):r>255?i.Result.Failure(s.Fault.Root(`${t} was too large to fit in a byte`)):i.Result.Success(new o(r)):i.Result.Failure(s.Fault.Root(`${t} was not an integer`))}static FromHexString(e,t="Byte.FromHexString input value"){return i.Result.FromBoolean(/^[0-9a-f]{2}$/.test(e)).replaceFailureWith(s.Fault.Root(`${t} is not a valid two-character hex string`)).map((()=>parseInt(e,16))).flatMap(o.From)}get value(){return this.valueOf()}valueOf(){return this.trustedNumber}toHexString(){return this.trustedNumber.toString(16).padStart(2,"0")}}t.Byte=o},7538:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Permutations=void 0;const s=r(6985);class i{elements;constructor(e){this.elements=e}*[Symbol.iterator](){yield*i.permute(this.elements)}static*permute(e){if(e.length<2)yield e;else for(const[t,r]of e.entries){let o=s.List.Empty();for(const[r,s]of e.entries)t.neq(r)&&(o=o.appendElement(s));for(const e of i.permute(o))yield s.List.Empty().appendElement(r).appendList(e)}}static*permuteInPlace(e){const t=e.length,r=new Array(t).fill(0);yield e;let s=0;for(;s<t;)if(r[s]<s){const t=s%2?r[s]:0,i=e[t];e[t]=e[s],e[s]=i,yield e,r[s]++,s=0}else r[s]=0,s++}}t.Permutations=i},4974:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Circle=void 0,t.Circle=class{center;radius;constructor(e,t){this.center=e,this.radius=t}}},6570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Integer=void 0;const s=r(6768),i=r(6129);class o extends i.AbstractNumberable{static NegativeOne=o.From(-1).orDie();static Zero=o.From(0).orDie();static One=o.From(1).orDie();static From(e,t="Integer.From input"){return s.Result.Success(e).test((e=>"number"==typeof e),`${t} must be a number`).test(Number.isInteger,`${t} must be an integer`).map((e=>new o(e)))}}t.Integer=o},3003:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonNegativeInteger=void 0;const s=r(6129),i=r(6570);class o extends s.AbstractNumberable{static Zero=new o(0);static One=new o(1);static From(e,t="NonNegativeInteger.From input"){return i.Integer.From(e,t).test((e=>e.value>=0),`${t} was negative`).map((e=>new o(e.value)))}toInteger(){return new i.Integer(Number(this.value))}inc(){return new o(this.value+1)}}t.NonNegativeInteger=o},7331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PositiveInteger=void 0;const s=r(6129),i=r(6570),o=r(3003);class n extends s.AbstractNumberable{static One=n.From(1).orDie();static Two=n.From(2).orDie();static From(e,t="PositiveInteger.From input"){return o.NonNegativeInteger.From(e,t).test((e=>e.neq(0)),`${t} was zero`).map((e=>new n(e.value)))}toInteger(){return new i.Integer(Number(this.value))}toNonNegativeInteger(){return new o.NonNegativeInteger(Number(this.value))}}t.PositiveInteger=n},1505:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntegerValidator=void 0;const s=r(2168),i=r(6570);class o extends s.AbstractValidator{validate(e,t){return i.Integer.From(e,t)}}t.IntegerValidator=o},7594:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractRandomDistribution=void 0;class r{*[Symbol.iterator](){for(;;)yield this.sample()}}t.AbstractRandomDistribution=r},6579:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8137:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UniformBooleanRandomDistribution=void 0;const s=r(6852),i=r(7594);class o extends i.AbstractRandomDistribution{source;constructor(e=new s.DefaultRandomSource){super(),this.source=e}sample(){return Number(this.source.sample())>.5}}t.UniformBooleanRandomDistribution=o},5066:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UniformRandomByteDistribution=void 0;const s=r(6985),i=r(4877),o=r(6852),n=r(7594),a=r(7438);class l extends n.AbstractRandomDistribution{integerValueDistribution;constructor(e=new o.DefaultRandomSource){super(),this.integerValueDistribution=new a.UniformRandomIntegerDistribution(s.NonNegativeInteger.Zero,s.NonNegativeInteger.From(255).orDie(),(e=>s.NonNegativeInteger.From(e).orDie()),e)}sample(){return i.Byte.From(Number(this.integerValueDistribution.sample())).orDie()}}t.UniformRandomByteDistribution=l},6990:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiscreteRandomDistribution=void 0;const s=r(6985),i=r(6852),o=r(7594),n=r(7438);class a extends o.AbstractRandomDistribution{values;indexDistribution;constructor(e,t=new i.DefaultRandomSource){super(),this.values=e,this.indexDistribution=new n.UniformRandomIntegerDistribution(s.NonNegativeInteger.Zero,s.NonNegativeInteger.From(e.length.value-1).orDie(),(e=>s.NonNegativeInteger.From(e).orDie()),t)}sample(){return this.values.get(this.indexDistribution.sample()).orDie()}}t.DiscreteRandomDistribution=a},7438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UniformRandomIntegerDistribution=void 0;const s=r(6852),i=r(7594);class o extends i.AbstractRandomDistribution{min;max;wrap;source;constructor(e,t,r,i=new s.DefaultRandomSource){super(),this.min=e,this.max=t,this.wrap=r,this.source=i}sample(){return this.wrap(Math.floor((this.max.value-this.min.value+1)*this.source.sample().value+this.min.value))}}t.UniformRandomIntegerDistribution=o},7353:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WeightedBooleanRandomDistribution=void 0;const s=r(6852),i=r(7594);class o extends i.AbstractRandomDistribution{trueThreshold;source;constructor(e,t=new s.DefaultRandomSource){super(),this.trueThreshold=e,this.source=t}sample(){return this.source.sample().gt(this.trueThreshold)}}t.WeightedBooleanRandomDistribution=o},6254:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomCoin=void 0;const s=r(6985),i=r(6852);t.RandomCoin=class{sideCount;booleanDistribution;constructor(e,t=new i.DefaultRandomSource){this.sideCount=e,this.booleanDistribution=new s.UniformBooleanRandomDistribution(t)}flipBoolean(){return this.booleanDistribution.sample()}flip(){return this.flipBoolean()?"heads":"tails"}}},7212:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomDie=void 0;const s=r(6985),i=r(7331),o=r(6852);class n{sideCount;distribution;constructor(e,t=new o.DefaultRandomSource){this.sideCount=e,this.distribution=new s.UniformRandomIntegerDistribution(i.PositiveInteger.One,e,(e=>i.PositiveInteger.From(e).orDie()),t)}static D4=new n(i.PositiveInteger.From(4).orDie());static D6=new n(i.PositiveInteger.From(6).orDie());static D8=new n(i.PositiveInteger.From(8).orDie());static D10=new n(i.PositiveInteger.From(10).orDie());static D12=new n(i.PositiveInteger.From(12).orDie());static D20=new n(i.PositiveInteger.From(20).orDie());roll(){return this.distribution.sample()}}t.RandomDie=n},3068:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MagicEightBall=void 0;const s=r(6409),i=r(6990),o=r(6852);t.MagicEightBall=class{responses=s.NonEmptyList.From(["It is Certain.","It is decidedly so.","Without a doubt.","Yes definitely.","You may rely on it.","As I see it, yes.","Most likely.","Outlook good.","Yes.","Signs point to yes.","Reply hazy, try again.","Ask again later.","Better not tell you now.","Cannot predict now.","Concentrate and ask again.","Don't count on it.","My reply is no.","My sources say no.","Outlook not so good.","Very doubtful."]).orDie();distribution;constructor(e=new o.DefaultRandomSource){this.distribution=new i.DiscreteRandomDistribution(this.responses,e)}shake(){return this.distribution.sample()}}},7276:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RandomArraySampler=void 0;const s=r(6990);class i extends s.DiscreteRandomDistribution{}t.RandomArraySampler=i},6852:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultRandomSource=void 0;const s=r(9259),i=r(7594);class o extends i.AbstractRandomDistribution{sample(){return s.Ratio.From(Math.random()||Number.EPSILON).orDie()}}t.DefaultRandomSource=o},711:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2784:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SeedableRandomSource=void 0;const s=r(6985),i=r(7594);class o extends i.AbstractRandomDistribution{seed;modulus=s.PositiveInteger.From(2147483647).orDie();multiplier=s.PositiveInteger.From(48271).orDie();constructor(e){super(),this.seed=s.PositiveInteger.From(e.value%this.modulus.value).orDie()}sample(){const e=new s.Ratio(this.seed,s.PositiveInteger.From(this.modulus.value-this.seed.value).orDie());return this.seed=s.PositiveInteger.From(this.multiplier.value*this.seed.value%this.modulus.value).orDie(),e}}t.SeedableRandomSource=o},9259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Ratio=void 0;const s=r(7331),i=r(6768),o=r(6129);class n extends o.AbstractNumberable{a;b;constructor(e,t){super(Number(e)/(Number(e)+Number(t))),this.a=e,this.b=t}static Min=new n(s.PositiveInteger.One,s.PositiveInteger.From((Number.MAX_SAFE_INTEGER-1)/2).orDie());static Half=new n(s.PositiveInteger.One,s.PositiveInteger.One);static Max=new n(s.PositiveInteger.From((Number.MAX_SAFE_INTEGER-1)/2).orDie(),s.PositiveInteger.One);static From(e,t="Ratio.From input"){if("number"!=typeof e)return i.Result.Failure(`${t} must be number`);if(n.Max.lt(e))return i.Result.Failure(`${t} must be less than ${n.Max}`);if(n.Min.gt(e))return i.Result.Failure(`${t} must be greater than ${n.Min}`);let r=e,o=1-e;for(;!Number.isInteger(r)||!Number.isInteger(o);)r*=2,o*=2;return i.Result.Success(new n(s.PositiveInteger.From(r).orDie(),s.PositiveInteger.From(o).orDie()))}static Clamp(e){return isNaN(Number(e))?n.Half:n.Max.lt(e)?n.Max:n.Min.gt(e)?n.Min:n.From(e).orDie()}}t.Ratio=n},807:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector2D=void 0;class r{x;y;constructor(e,t){this.x=e,this.y=t}scale(e){return new r(e*this.x,e*this.y)}add(e){return new r(this.x+e.x,this.y+e.y)}subtract(e){return this.add(e.scale(-1))}get squaredMagnitude(){return this.x*this.x+this.y*this.y}get magnitude(){return Math.sqrt(this.squaredMagnitude)}isLongerThan(e){return this.squaredMagnitude>e*e}isShorterThan(e){return this.squaredMagnitude<e*e}get unit(){return this.scale(1/this.magnitude)}}t.Vector2D=r},5454:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1748:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeJsHttpClient=void 0;const s=r(9317),i=r(4198),o=r(383),n=r(6768);t.NodeJsHttpClient=class{nativeHttpsModule;constructor(e){this.nativeHttpsModule=e}send(e){return new Promise((t=>{const r={};for(const t of e.headers)r[t.key]=t.value;const s=this.nativeHttpsModule.request(e.url,{method:e.method,headers:r}).on("response",(e=>{let r="";e.on("data",(e=>r+=e)),e.on("end",(()=>{t(n.Result.Success(new i.HttpResponse(this.normalizeResponseStatus(e.statusCode),r,this.normalizeResponseHeaders(e.headers))))}))}));"GET"!==e.method&&s.write(e.body),s.end()}))}normalizeResponseStatus(e){return o.HttpResponseStatus.Ok}normalizeResponseHeaders(e){let t=s.HttpHeaderCollection.Empty;for(const r in e){let s=e[r]||"";Array.isArray(s)&&(s=s.join(",")),t=t.set(r,s)}return t}}},5891:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeJsPlatform=void 0;const s=r(1748);t.NodeJsPlatform=class{httpsModule;constructor(e){this.httpsModule=e}get http(){return{client:new s.NodeJsHttpClient(this.httpsModule)}}}},1158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebHttpClient=void 0;const s=r(905),i=r(9317),o=r(4198),n=r(383),a=r(6768);t.WebHttpClient=class{webGlobal;constructor(e=window){this.webGlobal=e}async send(e){try{return a.Result.Success(await this.dewebifyResponse(await this.webGlobal.fetch(this.webifyRequest(e))))}catch{return a.Result.Failure(new s.HttpClientError)}}webifyRequest(e){const t=new Headers;for(const r of e.headers)t.set(r.key,r.value);const r="GET"===e.method?void 0:e.body;return new Request(e.url,{method:e.method,body:r,headers:t})}async dewebifyResponse(e){let t=i.HttpHeaderCollection.Empty;e.headers.forEach(((e,r)=>{t=t.set(r,e)}));const r=n.HttpResponseStatus.FromCodeNumber(e.status).replaceFailureWith(n.HttpResponseStatus.InternalServerError).value,s=await e.text();return new o.HttpResponse(r,s,t)}}},1459:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocket=void 0;const s=r(3243),i=r(9852),o=r(2104),n=r(1216),a=r(7117);class l{url;protocols;webGlobal;native=null;iterableEmitter=new s.IterableEventEmitter;constructor(e,t=[],r=window){this.url=e,this.protocols=t,this.webGlobal=r}async*[Symbol.asyncIterator](){for await(const e of this.iterableEmitter)yield e}get isOpen(){return!!this.native&&this.native.readyState===this.native.OPEN}open(){try{this.native=new this.webGlobal.WebSocket(this.url,this.protocols),this.native.onopen=()=>this.emit(new a.SocketOpenedEvent),this.native.onmessage=e=>this.emit(new n.SocketMessageReceivedEvent(e.data)),this.native.onerror=e=>this.emit(new o.SocketErrorEvent(String(e))),this.native.onclose=()=>{this.emit(new i.SocketClosedEvent)}}catch(e){this.emit(new o.SocketErrorEvent(String(e)))}}send(e){try{this.native&&this.isOpen?this.native.send(e):this.emit(new o.SocketErrorEvent("Cannot send -- socket not open"))}catch(e){this.emit(new o.SocketErrorEvent(String(e)))}}close(){try{this.native&&this.isOpen?this.native.close():this.emit(new o.SocketErrorEvent("Cannot close -- socket not open"))}catch(e){this.emit(new o.SocketErrorEvent(String(e)))}}emit(e){this.iterableEmitter.emit(e)}}t.WebSocket=l},5486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebPlatform=void 0;const s=r(1158),i=r(1459);t.WebPlatform=class{webGlobal;constructor(e=window){this.webGlobal=e}get http(){return{client:new s.WebHttpClient(this.webGlobal)}}socket(e,t=[]){return new i.WebSocket(e,t,this.webGlobal)}}},6768:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Result=void 0;class r{state;constructor(e){this.state=e}get succeeded(){return this.state[0]}get failed(){return!this.state[0]}get value(){return this.state[1]}toUnion(){return this.state[0]?{failed:!1,value:this.state[1]}:{failed:!0,value:this.state[1]}}static Success(e){return new r([!0,e])}static Failure(e){return new r([!1,e])}map(e){return this.state[0]?r.Success(e(this.state[1])):r.Failure(this.state[1])}flatMap(e){return this.state[0]?e(this.state[1]):r.Failure(this.state[1])}test(e,t){return this.state[0]?e(this.state[1])?r.Success(this.state[1]):r.Failure(t):r.Failure(this.state[1])}mapFailure(e){return this.state[0]?r.Success(this.state[1]):r.Failure(e(this.state[1]))}replaceFailureWith(e){return this.state[0]?r.Success(this.state[1]):r.Failure(e)}replaceSuccessWith(e){return this.state[0]?r.Success(e):r.Failure(this.state[1])}static FromBoolean(e){return e?r.Success(!0):r.Failure(!1)}toBoolean(){return this.state[0]}orDie(){const e=this.toUnion();if(e.failed)throw new Error(`Result#orDie fatal condition reached! Failure value: ${e.value}`);return e.value}}t.Result=r},6913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Signal=void 0;class r{asyncIterable;constructor(e){this.asyncIterable=e}static From(e){return new r(e)}async*[Symbol.asyncIterator](){for await(const e of this.asyncIterable)yield e}map(e){const t=this.asyncIterable;return new r({async*[Symbol.asyncIterator](){for await(const r of t)yield e(r)}})}async devour(){const e=this.asyncIterable[Symbol.asyncIterator]();for(;!(await e.next()).done;);}}t.Signal=r},9852:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketClosedEvent=void 0,t.SocketClosedEvent=class{}},2104:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketErrorEvent=void 0,t.SocketErrorEvent=class{error;constructor(e){this.error=e}}},6747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1216:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketMessageReceivedEvent=void 0,t.SocketMessageReceivedEvent=class{message;constructor(e){this.message=e}}},7117:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketOpenedEvent=void 0,t.SocketOpenedEvent=class{}},6190:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeDuration=void 0;const s=r(3003);class i{milliseconds;constructor(e){this.milliseconds=e}static ZeroMilliseconds=new i(s.NonNegativeInteger.From(0).orDie());static FromNumberOfMilliseconds(e){return s.NonNegativeInteger.From(e).map((e=>new i(e))).mapFailure((t=>`Could not parse number (${e}) as valid nonzero milliseconds because ${t}`))}wait(){return new Promise((e=>setTimeout(e,Number(this.milliseconds))))}}t.TimeDuration=i},2168:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractValidator=void 0;const s=r(3757);t.AbstractValidator=class{or(e){return new s.EitherValidator(this,e)}}},3757:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EitherValidator=void 0;const s=r(6768);class i{a;b;constructor(e,t){this.a=e,this.b=t}or(e){return new i(this,e)}validate(e,t){const r=this.a.validate(e,t).toUnion();if(!r.failed)return s.Result.Success(r.value);const i=this.b.validate(e,t).toUnion();return i.failed?s.Result.Failure(`${r.value} and ${i.value}`):s.Result.Success(i.value)}}t.EitherValidator=i},4222:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExactStringValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{comparisonValue;constructor(e){super(),this.comparisonValue=e}validate(e,t){return e!==this.comparisonValue?s.Result.Failure(`${t} was not equal to ${typeof this.comparisonValue} '${this.comparisonValue}'`):s.Result.Success(this.comparisonValue)}}t.ExactStringValidator=o},5080:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FixedNameValidator=void 0;const s=r(2168);class i extends s.AbstractValidator{name;validator;constructor(e,t){super(),this.name=e,this.validator=t}validate(e){return this.validator.validate(e,this.name)}}t.FixedNameValidator=i},7082:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Is=void 0;const s=r(1),i=r(4222),o=r(5080),n=r(508),a=r(7377),l=r(6654),c=r(5455),u=r(3527),d=r(6357),h=r(7056),p=r(1936);t.Is={List:{Of:e=>new s.ArrayOfValidator(e)},Exact:{String:e=>new i.ExactStringValidator(e)},Json:{String:{Of:e=>new n.JsonStringOfValidator(e)}},Named:(e,t)=>new o.FixedNameValidator(e,t),Number:new d.TypeOfNumberValidator,Object:{Of:e=>new c.ObjectOfValidator(e)},Optional:e=>t.Is.Undefined.or(e),Regex:{Match:{Of:e=>new u.RegexMatchArrayOfValidator(e)}},String:new h.TypeOfStringValidator,Undefined:new p.TypeOfUndefinedValidator,Non:{Empty:{List:{Of:e=>new a.NonEmptyListOfValidator(e)}}},Null:new l.NullValidator}},508:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JsonStringOfValidator=void 0;const s=r(6768),i=r(2168),o=r(7056);class n extends i.AbstractValidator{parsedJsonValidator;constructor(e){super(),this.parsedJsonValidator=e}validate(e,t){const r=(new o.TypeOfStringValidator).validate(e,t).toUnion();if(r.failed)return s.Result.Failure(r.value);try{return this.parsedJsonValidator.validate(JSON.parse(r.value),`JSON.parse(${t})`)}catch(e){return s.Result.Failure(`${t} was not a valid JSON string`)}}}t.JsonStringOfValidator=n},1:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayOfValidator=void 0;const s=r(6985),i=r(6768),o=r(2168);class n extends o.AbstractValidator{elementValidator;minLength;maxLength;constructor(e,t=0,r=1/0){super(),this.elementValidator=e,this.minLength=t,this.maxLength=r}validate(e,t){if(!Array.isArray(e))return i.Result.Failure(`${t} was not an array`);if(e.length<this.minLength)return i.Result.Failure(`${t} had ${e.length} elements, which is less than the minimum of ${this.minLength}`);if(e.length>this.maxLength)return i.Result.Failure(`${t} had ${e.length} elements, which is more than the maximum of ${this.maxLength}`);for(let r=0;r<e.length;r++){const s=e[r],o=this.elementValidator.validate(s,`${t}[${r}]`).toUnion();if(o.failed)return i.Result.Failure(o.value)}return i.Result.Success(new s.List(e))}}t.ArrayOfValidator=n},7377:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonEmptyListOfValidator=void 0;const s=r(6985),i=r(6409),o=r(2168);class n extends o.AbstractValidator{elementValidator;constructor(e){super(),this.elementValidator=e}validate(e,t){if(!Array.isArray(e))return s.Result.Failure(`${t} was not an array`);const[r,...o]=e;if(void 0===r)return s.Result.Failure(`${t} cannot be an empty array`);const n=this.elementValidator.validate(r,`${t}[0]`).toUnion();if(n.failed)return s.Result.Failure(n.value);let a=new i.NonEmptyList(n.value);for(let r=0;r<o.length;r++){const i=this.elementValidator.validate(e[r],`${t}[${r+1}]`).toUnion();if(i.failed)return s.Result.Failure(i.value);a=a.appendElement(i.value)}return s.Result.Success(a)}}t.NonEmptyListOfValidator=n},6654:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{validate(e,t){return null===e?s.Result.Failure(`${t} must be null`):s.Result.Success(null)}}t.NullValidator=o},5455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectOfValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{spec;constructor(e){super(),this.spec=e}validate(e,t){if("object"!=typeof e||null===e)return s.Result.Failure(`${t} was not a string-keyed object`);const r={};for(const i in this.spec){const o=`${t}['${i}']`,n=e[i],a=this.spec[i].validate(n,o);if(a.failed)return s.Result.Failure(a.value);r[i]=a.value}return s.Result.Success(r)}}t.ObjectOfValidator=o},3527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RegexMatchArrayOfValidator=void 0;const s=r(2168),i=r(5455);class o extends s.AbstractValidator{groupSpec;constructor(e){super(),this.groupSpec=e}validate(e,t){return new i.ObjectOfValidator({groups:new i.ObjectOfValidator(this.groupSpec)}).validate(e,t).map((e=>e.groups))}}t.RegexMatchArrayOfValidator=o},6357:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfNumberValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{validate(e,t){return s.Result.FromBoolean("number"==typeof e).replaceSuccessWith(e).replaceFailureWith(`${t} was not a number`)}}t.TypeOfNumberValidator=o},7056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfStringValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{validate(e,t){return s.Result.FromBoolean("string"==typeof e).replaceSuccessWith(e).replaceFailureWith(`${t} was not a string`)}}t.TypeOfStringValidator=o},1936:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfUndefinedValidator=void 0;const s=r(6768),i=r(2168);class o extends i.AbstractValidator{validate(e,t){return s.Result.FromBoolean(void 0===e).replaceSuccessWith(void 0).replaceFailureWith(`${t} was not undefined`)}}t.TypeOfUndefinedValidator=o},7749:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9157:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchHttpAppAccessAuthTokenLoader=void 0;const s=r(1237),i=r(6265),o=r(6768),n=r(7746),a=r(663),l=r(2796);t.TwitchHttpAppAccessAuthTokenLoader=class{httpClient;bodyValidator=n.Is.Named("TwitchHttpAppAccessAuthTokenClient Response Body",n.Is.Json.String.Of(n.Is.Object.Of({token_type:n.Is.Exact.String("bearer"),access_token:n.Is.String,expires_in:n.Is.Number})));constructor(e){this.httpClient=e}async load(e,t){const r=new s.HttpRequest("POST",`https://id.twitch.tv/oauth2/token?${i.HttpRequestUrlQuery.FromObject({client_id:e,client_secret:t,grant_type:"client_credentials"})}`);return(await this.httpClient.send(r)).flatMap((e=>o.Result.FromBoolean(e.ok).replaceSuccessWith(e).replaceFailureWith(new a.TwitchHttpFailureResponseError(e)))).flatMap((e=>this.bodyValidator.validate(e.body).map((t=>e.structure(t))).mapFailure((t=>new l.TwitchHttpMalformedResponseBodyError(t,e.body)))))}}},663:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchHttpFailureResponseError=void 0,t.TwitchHttpFailureResponseError=class{httpResponse;constructor(e){this.httpResponse=e}}},2796:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchHttpMalformedResponseBodyError=void 0,t.TwitchHttpMalformedResponseBodyError=class{validationErrorMessage;body;constructor(e,t){this.validationErrorMessage=e,this.body=t}}},4542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchApiFollowsLoader=void 0;const s=r(6985),i=r(9317),o=r(1237),n=r(6265);t.TwitchApiFollowsLoader=class{httpClient;responseBodyValidator=s.Is.Named("Twitch API User Follows Response Body",s.Is.Json.String.Of(s.Is.Object.Of({data:s.Is.List.Of(s.Is.Object.Of({followed_at:s.Is.String,from_id:s.Is.String,from_login:s.Is.String,from_name:s.Is.String,to_id:s.Is.String,to_login:s.Is.String,to_name:s.Is.String})),pagination:s.Is.Object.Of({cursor:s.Is.Optional(s.Is.String)}),total:s.Is.Number})));constructor(e){this.httpClient=e}async loadUserFollows(e,t,r,a,l){let c=n.HttpRequestUrlQuery.Empty;return e&&(c=c.add("after",e)),t&&(c=c.add("first",String(t))),r&&(c=c.add("from_id",r)),a&&(c=c.add("to_id",a)),this.httpClient.send(new o.HttpRequest("GET",`https://api.twitch.tv/helix/users/follows${c.isEmpty?"":"?"}${c}`,i.HttpHeaderCollection.From({Authorization:`Bearer ${l.value}`,"Client-Id":l.clientId}))).then((e=>e.flatMap((e=>s.Result.FromBoolean(e.ok).replaceSuccessWith(e).replaceFailureWith(new s.TwitchHttpFailureResponseError(e)))).flatMap((e=>this.responseBodyValidator.validate(e.body).map((t=>e.structure(t))).mapFailure((t=>new s.TwitchHttpMalformedResponseBodyError(t,e.body)))))))}}},3833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchApiUsersLoader=void 0;const s=r(4112),i=r(9317),o=r(1237),n=r(6265),a=r(6768),l=r(7746),c=r(663),u=r(2796);t.TwitchApiUsersLoader=class{httpClient;responseBodyValidator=l.Is.Named("TwitchUsersHttpClient Response Body",l.Is.Json.String.Of(l.Is.Object.Of({data:l.Is.List.Of(l.Is.Object.Of({id:l.Is.String,login:l.Is.String,display_name:l.Is.String,description:l.Is.String,broadcaster_type:l.Is.Exact.String("").or(l.Is.Exact.String("partner")).or(l.Is.Exact.String("affiliate")),offline_image_url:l.Is.String,profile_image_url:l.Is.String,type:l.Is.Exact.String("").or(l.Is.Exact.String("staff")).or(l.Is.Exact.String("admin")).or(l.Is.Exact.String("global_mod")),view_count:l.Is.Number,created_at:l.Is.String,email:l.Is.Optional(l.Is.String)}))})));constructor(e){this.httpClient=e}async load(e,t,r){const l=e.length+t.length;if(l>100)return a.Result.Failure(s.Fault.Root("Too many ids/logins were passed to the Twitch http users getter",{idOrLoginCount:String(l),userIds:JSON.stringify(e),userLogins:JSON.stringify(t)}));let d=n.HttpRequestUrlQuery.Empty;for(const t of e)d=d.add("id",t);for(const e of t)d=d.add("login",e);return(await this.httpClient.send(new o.HttpRequest("GET",`https://api.twitch.tv/helix/users${d.isEmpty?"":"?"}${d}`,i.HttpHeaderCollection.Empty.set("Authorization",`Bearer ${r.value}`).set("Client-Id",r.clientId)))).flatMap((e=>a.Result.FromBoolean(e.ok).replaceSuccessWith(e).replaceFailureWith(new c.TwitchHttpFailureResponseError(e)))).flatMap((e=>this.responseBodyValidator.validate(e.body).map((t=>e.structure(t))).mapFailure((t=>new u.TwitchHttpMalformedResponseBodyError(t,e.body)))))}}},9437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchAppAccessAuthenticator=void 0;const s=r(9157),i=r(6777);t.TwitchAppAccessAuthenticator=class{nowSource;httpLoader;constructor(e,t=Date.now){this.nowSource=t,this.httpLoader=new s.TwitchHttpAppAccessAuthTokenLoader(e)}async authenticate(e,t){return(await this.httpLoader.load(e,t)).map((e=>e.body)).map((t=>new i.TwitchAppAccessAuthToken(e,t.token_type,t.access_token,new Date(this.nowSource()+1e3*t.expires_in))))}}},351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchUserAccessAuthenticator=void 0;const s=r(6265),i=r(7746),o=r(2436),n=r(2647),a=i.Is.Named("Twitch user access auth token implicit code flow hash parameters",i.Is.Object.Of({token_type:i.Is.Exact.String("bearer"),access_token:i.Is.String,scope:i.Is.List.Of(new o.TwitchAuthScopeValidator),state:i.Is.String}));class l{webGlobal;constructor(e=window){this.webGlobal=e}static BuildAuthPageUrl(e,t,r,i=!1,o=""){return`https://id.twitch.tv/oauth2/authorize?${s.HttpRequestUrlQuery.FromObject({client_id:e,redirect_uri:t,response_type:"token",scope:r.join(" "),force_verify:i,state:o})}`}authenticate(e,t,r,i=!1,o=""){const c=s.HttpRequestUrlQuery.FromString(this.webGlobal.location.hash.slice(1)),u=a.validate({token_type:c.getFirst("token_type").value,access_token:c.getFirst("access_token").value,scope:c.getFirst("scope").replaceFailureWith("").value.split(" "),state:c.getFirst("state").replaceFailureWith("").value}).toUnion();if(u.failed){const s=l.BuildAuthPageUrl(e,t,r,i,o);throw this.webGlobal.location.href=s,new Error(`Well this is awkward... you should have redirected to ${s}`)}const{token_type:d,access_token:h,scope:p}=u.value;return new n.TwitchUserAccessAuthToken(e,d,h,p)}}t.TwitchUserAccessAuthenticator=l},3102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2436:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchAuthScopeValidator=void 0;const s=r(2168),i=r(7746);class o extends s.AbstractValidator{static validator=i.Is.Exact.String("bits:read").or(i.Is.Exact.String("chat:read")).or(i.Is.Exact.String("chat:edit"));validate(e,t){return o.validator.validate(e,t)}}t.TwitchAuthScopeValidator=o},6777:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchAppAccessAuthToken=void 0,t.TwitchAppAccessAuthToken=class{clientId;type;value;expirationDate;constructor(e,t,r,s){this.clientId=e,this.type=t,this.value=r,this.expirationDate=s}}},5065:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2647:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchUserAccessAuthToken=void 0,t.TwitchUserAccessAuthToken=class{clientId;type;value;scopes;constructor(e,t,r,s){this.clientId=e,this.type=t,this.value=r,this.scopes=s}}},8350:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchChatClient=void 0;const s=r(3243),i=r(1603),o=r(1158),n=r(1459),a=r(6768),l=r(9852),c=r(2104),u=r(1216),d=r(7117),h=r(8439),p=r(2556),m=r(7360);class f{broadcaster;send;messages;constructor(e,t,r){this.broadcaster=e,this.send=t,this.messages=r}}class v{userAccessAuthToken;static ircParser=new i.IrcV3Parser;socket=new n.WebSocket("wss://irc-ws.chat.twitch.tv/",["irc"]);static READ_AUTH_SCOPE="chat:read";static WRITE_AUTH_SCOPE="chat:edit";userLoader;errors=new s.IterableEventEmitter;cache={};isInitialized=!1;constructor(e,t=new o.WebHttpClient(window)){this.userAccessAuthToken=e,this.userLoader=new h.TwitchUserLoader(e,t)}async connect(e){if(!this.isInitialized){const e=(await this.initialize()).toUnion();if(e.failed)return a.Result.Failure(e.value)}const t=this.cache[e.loginName];if(t)return a.Result.Success(t.connection);this.socket.send(`JOIN #${e.loginName}`);const r=new s.IterableEventEmitter,i=new f(e,(t=>{this.socket.send(`PRIVMSG #${e.loginName} :${t}`)}),{async*[Symbol.asyncIterator](){for await(const e of r)yield e}});return this.cache[e.loginName]={connection:i,messagesEventEmitter:r},a.Result.Success(i)}initialize(){return new Promise((async(e,t)=>{if(this.isInitialized)return e(a.Result.Success(!0));const r=(await this.userLoader.loadSelf()).toUnion();if(r.failed)return e(a.Result.Failure(new m.TwitchChatClientError("Failed to load chatter identity from authorization token",r.value)));const s=r.value;this.socket.open();for await(const r of this.socket){if(r instanceof d.SocketOpenedEvent){this.socket.send("CAP REQ :twitch.tv/tags twitch.tv/commands twitch.tv/membership"),this.socket.send(`PASS oauth:${this.userAccessAuthToken.value}`),this.socket.send(`NICK ${s.loginName}`);for(const e in this.cache)this.socket.send(`JOIN #${e}`);this.isInitialized||(this.isInitialized=!0,e(a.Result.Success(!0)))}if(r instanceof u.SocketMessageReceivedEvent)for(const e of v.ircParser.parse(r.message))if("PING"===e.command&&this.socket.send(`PONG :${e.parameters[0]}`),"PRIVMSG"===e.command){const t=(e.parameters[0]||"").slice(1),r=this.cache[t];if(r){const t=e.tags["display-name"]||"",s=(e.parameters[1]||"").toLowerCase().trim();r.messagesEventEmitter.emit(new p.TwitchChatMessage(t,s))}else this.errors.emit(new m.TwitchChatClientError(`Received PRIVMSG for channel #${t}, which you were not listening for...`))}r instanceof c.SocketErrorEvent&&(this.isInitialized||t(a.Result.Failure(new m.TwitchChatClientError("Socket error encountered before initialization could complete",r))),this.errors.emit(new m.TwitchChatClientError("Socket Error Encountered",r))),r instanceof l.SocketClosedEvent&&(this.errors.emit(new m.TwitchChatClientError("Reconnecting...")),this.socket.open())}}))}}t.TwitchChatClient=v},7360:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchChatClientError=void 0,t.TwitchChatClientError=class{message;cause;constructor(e,t){this.message=e,this.cause=t}}},2556:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchChatMessage=void 0,t.TwitchChatMessage=class{senderDisplayName;text;constructor(e,t){this.senderDisplayName=e,this.text=t}get words(){return this.text.trim().replace(/\s+/g," ").split(" ")}}},3604:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchFollowerCountLoader=void 0;const s=r(6985),i=r(4542);t.TwitchFollowerCountLoader=class{authToken;apiFollowsLoader;constructor(e,t=new s.WebHttpClient(window)){this.authToken=e,this.apiFollowsLoader=new i.TwitchApiFollowsLoader(t)}loadFollowerCount(e){return this.apiFollowsLoader.loadUserFollows("",1,"",e.id,this.authToken).then((e=>e.map((e=>e.body.total))))}}},8439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchUserLoader=void 0;const s=r(4112),i=r(1158),o=r(3833),n=r(9122);t.TwitchUserLoader=class{authToken;httpUsersLoader;constructor(e,t=new i.WebHttpClient(window)){this.authToken=e,this.httpUsersLoader=new o.TwitchApiUsersLoader(t)}async loadSelf(){return(await this.httpUsersLoader.load([],[],this.authToken)).map((e=>e.body.data)).flatMap((e=>e.first.replaceFailureWith(s.Fault.Root("No user associated with auth token")))).map((e=>new n.TwitchUser(e.id,e.login,e.display_name,e.description,e.profile_image_url)))}async loadByLogin(e){return(await this.httpUsersLoader.load([],[e],this.authToken)).map((e=>e.body.data)).test((e=>e.length<2),s.Fault.Root("Multiple users found")).flatMap((e=>e.first.replaceFailureWith(s.Fault.Root("User not found for login")))).map((e=>new n.TwitchUser(e.id,e.login,e.display_name,e.description,e.profile_image_url)))}}},9122:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwitchUser=void 0,t.TwitchUser=class{id;loginName;displayName;description;profilePictureUrl;constructor(e,t,r,s,i){this.id=e,this.loginName=t,this.displayName=r,this.description=s,this.profilePictureUrl=i}}},6985:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(6409),t),i(r(8518),t),i(r(9291),t),i(r(6768),t),i(r(5455),t),i(r(1),t),i(r(3527),t),i(r(7377),t),i(r(508),t),i(r(7082),t),i(r(6654),t),i(r(7746),t),i(r(4222),t),i(r(3757),t),i(r(7056),t),i(r(1936),t),i(r(6357),t),i(r(5080),t),i(r(2168),t),i(r(9804),t),i(r(1748),t),i(r(5891),t),i(r(1459),t),i(r(1158),t),i(r(5486),t),i(r(5454),t),i(r(1603),t),i(r(9849),t),i(r(5298),t),i(r(2282),t),i(r(9259),t),i(r(6129),t),i(r(7538),t),i(r(4877),t),i(r(3003),t),i(r(6570),t),i(r(7331),t),i(r(1505),t),i(r(4974),t),i(r(6852),t),i(r(711),t),i(r(2784),t),i(r(7353),t),i(r(5066),t),i(r(7438),t),i(r(8137),t),i(r(6990),t),i(r(6579),t),i(r(7594),t),i(r(6254),t),i(r(3068),t),i(r(7212),t),i(r(7276),t),i(r(807),t),i(r(9053),t),i(r(3863),t),i(r(7524),t),i(r(3134),t),i(r(383),t),i(r(3124),t),i(r(4198),t),i(r(3258),t),i(r(6265),t),i(r(1237),t),i(r(7572),t),i(r(905),t),i(r(9317),t),i(r(304),t),i(r(4112),t),i(r(3140),t),i(r(3243),t),i(r(6913),t),i(r(1232),t),i(r(7749),t),i(r(2556),t),i(r(8350),t),i(r(7360),t),i(r(2647),t),i(r(6777),t),i(r(5065),t),i(r(3102),t),i(r(2436),t),i(r(351),t),i(r(9437),t),i(r(8439),t),i(r(9122),t),i(r(3604),t),i(r(9157),t),i(r(3833),t),i(r(4542),t),i(r(2796),t),i(r(663),t),i(r(6190),t),i(r(9852),t),i(r(2104),t),i(r(7117),t),i(r(6747),t),i(r(1216),t)}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=r(6985),t=document.getElementById("canvas"),s=t.getContext("2d"),i={type:"PICK",color:{yellowGreenRatio:e.Ratio.Half,lightnessRatio:e.Ratio.Half}};function o(){var e=window.devicePixelRatio||1;t.style.width="".concat(window.innerWidth,"px"),t.style.height="".concat(window.innerHeight,"px"),t.width=Math.floor(e*window.innerWidth),t.height=Math.floor(e*window.innerHeight),s.scale(e,e),s.fillStyle="hsl(180,100%,1%,100%)",s.fillRect(0,0,window.innerWidth,window.innerHeight),"PICK"===i.type&&function(e){var t=window.innerWidth,r=.5*window.innerHeight,i=.1*r,o=r-2*i,n=(t-r)/2+i,a=32+i;s.fillStyle="hsl(".concat(120-60*e.color.yellowGreenRatio.value,",100%,").concat(100*e.color.lightnessRatio.value,"%)"),s.fillRect(n,a,o,o)}(i)}o(),window.addEventListener("resize",o)})()})();